{
  "version": 3,
  "file": "iot.714a60c4.css",
  "sources": [
    "../../../../../../src/components/Map.svelte",
    "../../../../../../src/components/ActorStatus.svelte",
    "../../../../../../src/routes/iot.svelte"
  ],
  "sourcesContent": [
    "<style>\n    .actor {\n        color: rgba(158, 36, 123, 1);\n        position: absolute;\n    }\n    \n    #map {\n        grid-column: 1;\n        /* grid-row: 3; */\n        width: 100%;\n        /* VH of 72 seems to align well with 7 actors */\n        height: 72vh;\n        position: relative;\n        border: 1px solid #aaa;\n        border-radius: 2px;\n        box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);\n    }\n    \n    #map>p {\n        margin: 0;\n        border: 0;\n        padding: 0;\n        line-height: 0;\n    }\n    \n    button {\n        grid-row: 4;\n    }\n    \n    p {\n        margin: 1em auto;\n    }\n    \n    @media (min-width: 480px) {\n        h1 {\n            font-size: 4em;\n        }\n    }\n</style>\n\n\n\n<script>\n    import {\n        actors,\n        map\n    } from '../routes/stores.js'\n    let x, y\n    $: actor_list = gen_actor_list()\n\n\n\n    let messages = ''\n    let data = []\n\n    let prev_messages = ''\n    let new_messages = ''\n\n    let current_host;\n\n\n    // Prevennts an error when Svelte does SSR.\n    if (true) {\n        let xhr = new XMLHttpRequest()\n        current_host = window.location.host.toString();\n        console.log('current host is: ', current_host)\n    }\n\n    //need to create an array of actors because Svelte can't iterate over Map objects\n    function gen_actor_list() {\n        // let arr = [];\n        $actors = []\n        for (let item of $map.keys()) {\n            $actors.push(item)\n        }\n        return $actors\n    }\n\n    function process_map_data(data_point_array) {\n        let data_point;\n        //handle multiple data points sent in a single update\n        if (data_point_array[data_point_array.length - 1].length > 1) {\n            data_point_array = data.slice(-1)\n                //console.log(\"data_point_array is: \")\n                //console.log(data_point_array)\n            data_point_array.forEach(function(item, index) {\n                item.forEach(function(sub_item, index) {\n                    //console.log(sub_item, index);\n                    process_data_point(sub_item)\n                })\n            })\n\n            //console.log('data_point_array - if')\n            //console.log(data_point_array)\n        } else {\n            data_point_array = data.slice(-1)\n            process_data_point(data_point_array)\n                //console.log('data_point_array - else')\n                //console.log(data_point_array)\n        }\n\n        function process_data_point(data_point) {\n            // let data_point = data_point_array[data_point_array.length - 1]\n            //console.log('data_point: ')\n            //console.log(data_point)\n            try {\n                data_point = JSON.parse(data_point)\n            } catch (error) {\n                //console.error(error)\n                return\n            }\n\n            //console.log(\"parsed data_point\")\n            //console.log(data_point)\n\n            let actor = data_point.actor\n            if (data_point.x <= 0) {\n                x = 0\n            } else if (data_point.x >= 90) {\n                x = 90\n            } else {\n                x = data_point.x\n            }\n\n            if (data_point.y <= 5) {\n                y = 5\n            } else if (data_point.y >= 95) {\n                y = 95\n            } else {\n                y = data_point.y\n            }\n            //console.log(x)\n            //console.log(y)\n            //console.log(actor)\n\n            $map.set(actor, {\n                'x': x,\n                'y': y\n            })\n        }\n    }\n\n\n\n    async function fetch_map(event) {\n        let xhr = new XMLHttpRequest()\n        xhr.responseType = 'text';\n        let url = 'https://' + current_host + '/kafka-client-api/read?topic=actors'\n        console.log(\"url is: \", url)\n        xhr.open(\"GET\", url)\n        xhr.timeout = Infinity;\n        xhr.onloadstart = function() {\n            //console.log(\"Download underway\");\n        };\n        xhr.onprogress = function(event) {\n            let response = xhr.response\n                // trim the last message's trailing '::::' and split on '::::'\n            new_messages = response.slice(prev_messages.length, response.length - 4).split('::::')\n            prev_messages = response\n                //console.log('new_msgs')\n                //console.log(new_messages)\n            data.push(new_messages)\n                // set data = data to trigger view update, keeping only last 100 messages in order to prevent browser from getting bogged down.\n            if (data.length >= 100) {\n                data = data.splice(-100, data.length)\n            } else {\n                data = data\n            }\n            // set x and y coords\n            //console.log('data.slice(-1)')\n            //console.log(data.slice(-1))\n\n            process_map_data(data.slice(-1))\n                // let data_point_array = data.slice(-1)\n                //call gen_actor_list to update list of actors\n                //TODO: confirm if this step is necessary, given it's defined as reactive above-- $: actor_list = gen_actor_list()\n            actor_list = gen_actor_list()\n        };\n        xhr.send()\n        xhr.onload = function() {\n            //TODO: reconnect on completion\n            //console.log(xhr.response)\n        }\n    }\n</script>\n\n\n<div id=\"map\">\n    {#each actor_list as actor}\n    <p class='actor' id={actor} style=\"left: {$map.get(actor)['x']}%; bottom: {$map.get(actor)['y']}%;\">ðŸ¤–{actor}</p>\n    {/each}\n\n</div>\n\n<button on:click={fetch_map}>\n        Click me to start data stream\n</button>",
    "<style>\n    #actor_status {\n        overflow: scroll;\n        padding: 0;\n        margin: 0;\n        height: 72vh;\n    }\n    \n    #actor_status ul {\n        /* Remove indentation for list items */\n        padding: 0;\n    }\n    \n    #actor_list {\n        padding: 0;\n        margin-top: 0;\n    }\n    \n    .actor_list__item {\n        display: block;\n        list-style-type: none;\n        margin-bottom: .5em;\n        text-align: left;\n        border: 1px solid #aaa;\n        border-radius: 2px;\n        box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);\n        padding-bottom: 0em;\n        padding-left: 1em;\n    }\n    \n    .actor_list__actor_name {\n        font-weight: bold;\n        display: block;\n        padding-top: .5em;\n        padding-bottom: .5em;\n    }\n    \n    hr {\n        border-top: 3px #333;\n        color: #333;\n        overflow: hidden;\n        margin-top: 0;\n    }\n    \n    .actor_list__actor_details {\n        padding-top: .5em;\n        padding-bottom: .5em;\n        display: flex;\n    }\n    \n    .actor_list__actor_coordinates {\n        margin-right: auto;\n    }\n    \n    .actor_list__actor_status {\n        margin-right: .5em;\n    }\n</style>\n\n<script>\n    import {\n        actors,\n        map\n    } from '../routes/stores.js'\n    // For local testing when no Kafka or API server avaiable\n    // $map.set('actor1', {\"x\": \"12\", \"y\":\"12\"})\n    // $actors.push('actor1')\n    // $map.set('actor2', {\"x\": \"12\", \"y\":\"12\"})\n    // $actors.push('actor2')\n    // $map.set('actor3', {\"x\": \"12\", \"y\":\"12\"})\n    // $actors.push('actor3')\n    // $map.set('actor4', {\"x\": \"12\", \"y\":\"12\"})\n    // $actors.push('actor4')\n    // $map.set('actor5', {\"x\": \"12\", \"y\":\"12\"})\n    // $actors.push('actor5')\n    // $map.set('actor6', {\"x\": \"12\", \"y\":\"12\"})\n    // $actors.push('actor6')\n    // $map.set('actor7', {\"x\": \"12\", \"y\":\"12\"})\n    // $actors.push('actor7')\n    // $map.set('actor8', {\n    //     \"x\": \"12\",\n    //     \"y\": \"12\"\n    // })\n    // $actors.push('actor8')\n</script>\n\n<div id=\"actor_status\">\n    <ul id=\"actor_list\">\n        {#if $actors.length == 0}\n        <p>Waiting for data...</p>\n        {:else} {#each $actors as actor}\n        <li class=\"actor_list__item\">\n            <span class=\"actor_list__actor_name\">\n                    {actor} \n                </span>\n            <hr />\n            <div class=\"actor_list__actor_details\">\n                <span class=\"actor_list__actor_coordinates\">\n                        x: {$map.get(actor)['x']}, y: {$map.get(actor)['y']}\n                    </span>\n                <span class=\"actor_list__actor_status\">\n                        Status: <span style=\"color: green;\">OK</span>\n                </span>\n            </div>\n        </li>\n        {/each} {/if}\n    </ul>\n</div>",
    "<script>\n    import {\n        fade,\n        fly,\n        slide\n    } from 'svelte/transition';\n\n    import Map from '../components/Map.svelte';\n    import ActorStatus from '../components/ActorStatus.svelte';\n    let src = '2019_07_19-arch-diagram.svg'\n    let arch_collapsed = false\n\n    function handle_collapse_click(e) {\n        arch_collapsed = !arch_collapsed\n    }\n</script>\n\n<style>\n    .header {\n        grid-column: 1 / -1;\n    }\n    \n    h1 {\n        font-size: 2.8em;\n        text-transform: uppercase;\n        font-weight: 700;\n        margin: 0 0 0.5em 0;\n        text-align: center;\n        color: rgba(51, 0, 114, 1)\n    }\n    \n    #architecture__collapse__button {\n        z-index: 1;\n        /* width: 2.5em; */\n        /* height: 1em; */\n        /* margin: 0;\n        padding: 0; */\n        font-size: 150%;\n        border: 1px solid rgba(83, 86, 90, 1);\n        cursor: pointer;\n        /* margin: auto; */\n        color: rgba(255, 255, 255, 1);\n        border-radius: 1rem;\n        margin-right: auto;\n        margin-bottom: auto;\n        position: absolute;\n        top: 0;\n        left: -1.5em;\n    }\n    \n    #map {\n        grid-column: 1;\n    }\n    \n    button,\n    button:link,\n    button:visited {\n        text-transform: uppercase;\n        text-decoration: none;\n        /* padding: 1.5rem 1.5rem; */\n        /* display: inline-block; */\n        border-radius: 3rem;\n        -webkit-transition: all 0.2s;\n        transition: all 0.2s;\n        position: relative;\n        font-size: 150%;\n        /* border: 1px solid rgba(51, 0, 114, 1); */\n        cursor: pointer;\n        margin-right: auto;\n        margin-bottom: auto;\n        /* color: rgba(51, 0, 114, 1); */\n        background-color: rgba(51, 0, 114, 1);\n    }\n    \n    button:hover,\n    button:link:hover,\n    button:visited:hover {\n        -webkit-transform: translateY(-3px);\n        transform: translateY(-3px);\n        -webkit-box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.2);\n        box-shadow: 0 1rem 2rem rgba(0, 0, 0, 0.2)\n    }\n    \n    button:hover::after,\n    button:link:hover::after,\n    button:visited:hover::after {\n        -webkit-transform: scaleX(1.4) scaleY(1.6);\n        transform: scaleX(1.4) scaleY(1.6);\n        opacity: 0\n    }\n    \n    button:active,\n    button:focus,\n    button:link:active,\n    button:link:focus,\n    button:visited:active,\n    button:visited:focus {\n        outline: none;\n        -webkit-transform: translateY(-1px);\n        transform: translateY(-1px);\n        -webkit-box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.2);\n        box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.2)\n    }\n    \n    button::after {\n        content: \"\";\n        display: inline-block;\n        height: 100%;\n        width: 100%;\n        border-radius: 10rem;\n        position: absolute;\n        top: 0;\n        left: 0;\n        z-index: -1;\n        -webkit-transition: all 0.4s;\n        transition: all 0.4s\n    }\n    \n    #architecture__diagram {\n        grid-column: 1 / -1;\n        grid-row: 2;\n        z-index: 2;\n        /* height: 90vh; */\n    }\n    \n    #architecture__diagram img {\n        width: 100%;\n        box-shadow: 2px 2px 8px rgba(0, 0, 0, 0.1);\n    }\n    \n    #architecture__diagram button {\n        width: 1em;\n    }\n</style>\n\n<div class=\"header\">\n    <h1>Factory Status</h1>\n</div>\n<span style=\"position: relative; grid-row: 2; grid-column: 1 /2;\">\n<button id=\"architecture__collapse__button\" on:click={handle_collapse_click} in:fade=\"{{duration: 200}}\" out:fade=\"{{duration: 0}}\">\n            {arch_collapsed ? \"+\" : \"-\"}\n</button>\n</span> {#if !arch_collapsed}\n\n<div id=\"architecture__diagram\" in:fade=\"{{duration: 200}}\" out:fade=\"{{duration: 0}}\">\n    <img {src} alt=\"architecture diagram\">\n</div>\n{:else}\n<div id=\"map\" in:fade=\"{{duration: 200}}\" out:fade=\"{{duration: 0}}\">\n    <Map />\n</div>\n<div id=\"actor_status\" in:fade=\"{{duration: 200}}\" out:fade=\"{{duration: 0}}\">\n    <ActorStatus />\n</div>\n{/if}"
  ],
  "names": [],
  "mappings": "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"
}